## Dynamic configuration
## path to place the file
## scp -P 2222 external/services.yml sihuan@knhcloud:/volume4/dockume/traefik/external
## scp -P 2222 external/services.yml sihuan@192.168.2.72:/volume4/dockume/traefik/external

http:
  routers:
    to-nginx:
      entryPoints:
        - "web"
        - "websecure"
      rule: "Host(`192.168.2.72`, `172.16.103.98`)"
      tls: {}
      service: nginx

    to-fief-server:
      entryPoints:
        - "fief"
      rule: "Host(`192.168.2.72`, `172.16.103.98`)"
      service: fief-server

    to-fief-postgres:
      entryPoints:
        - "postgresql"
      rule: "Host(`192.168.2.72`, `172.16.103.98`)"
      service: fief-postgres

  services:
    nginx:
      loadBalancer:
        servers:
        - url: "http://nginx:80"

    fief-server:
      loadBalancer:
        servers:
        - url: "http://fief-server:8000"

    fief-postgres:
      loadBalancer:
        servers:
        - url: "http://fief-postgres:5432"
